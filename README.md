
<h1>Introduction</h1>

VOYEUR's main purpose is to automate several tasks of an Active Directory build review or security assessment. Also, the tool is able to create a fast (and pretty) Active Directory report. The tool is developed entirely in PowerShell (a powerful scripting language) without dependencies like Microsoft Remote Administration tools. (Just .Net Framework 4.5, WMF 5.0 and Office Excel if you want a useful and pretty report). The generated report is a perfect starting point for well-established forensic, incident response team, security consultants or security researchers who want to quickly analyze threats in Active Directory Services.

<h1>Features</h1>

* Return a huge number of attributes on computers, users, containers/OUs, groups, ACL, etc...
* Search for locked accounts, expired password, no password policy, etc...
* Return a list of all privileged account in domain. (The script search in SID value instead in a group name)
* Return a list of groupâ€™s modification (Users added/deleted for a specific group, etc...)
* Multi-Threading support
* Plugin Support

<h1>Usage scenarios</h1>

VOYEUR can be used in two ways scenarios:

* Able for using on local or remote computer
* Able for using on joined machine or workgroup machine

<h1>Screenshots</h1>

![voyeur](https://cloud.githubusercontent.com/assets/5271640/17643817/19b20958-6143-11e6-8e3a-41a4bec132df.png)

<h1>Reporting</h1>

Support for exporting data driven to several formats like CSV, XML or JSON (Experimental).

The following screenshot shows an example report in JSON format

![voyeur_jsonreport](https://cloud.githubusercontent.com/assets/5271640/17643845/d5a545da-6143-11e6-8769-32008d19f638.PNG)

<h1>Office Support</h1>

Support for exporting data driven to EXCEL format. The tool also support table style modification, chart creation, company logo or independent language support. At the moment only Office Excel 2010 and Office Excel 2013 are supported by the tool.

![voyeurexcelreport](https://cloud.githubusercontent.com/assets/5271640/17643864/55bfa3dc-6144-11e6-8266-29487b4f167f.PNG)

<h1>Sample reports</h1>

An example of report generated by Voyeur can be downloaded from [Voyeur_Report_20160609.xlsx](https://github.com/silverhack/voyeur/files/416616/Voyeur_Report_20160609.xlsx)

<h1>Prerequisites</h1>

Voyeur works out of the box with PowerShell version 2.x. You can check your Windows PowerShell version executing the command <b>$PsVersionTable:</b>

```powershell
PS C:\Users\silverhack> $psversiontable

Name                           Value
----                           -----
CLRVersion                     2.0.50727.5420
BuildVersion                   6.1.7601.17514
PSVersion                      2.0
WSManStackVersion              2.0
PSCompatibleVersions           {1.0, 2.0}
SerializationVersion           1.1.0.1
PSRemotingProtocolVersion      2.1
```

<h1>Installation</h1>

You can download the latest zip by clicking [https://github.com/silverhack/voyeur/archive/master.zip here].

Preferably, you can download voyeur by cloning the [https://github.com/silverhack/voyeur] repository:

<pre>
git clone https://github.com/silverhack/voyeur
</pre>

<h1>Usage</h1>

To get a list of basic options and switches use:

```powershell
get-help .\voyeur.ps1
```

To get a list of examples use:

```powershell
get-help .\voyeur.ps1 -Examples
```

To get a list of all options and examples with detailed info use:

```powershell
get-help .\voyeur.ps1 -Detailed
```

<h1>Examples</h1>

This example retrieve information of an Active Directory for a specific domain. Also, retrieve Organizational Unit
information and ACL values. Next, export all data driven to JSON format.

```powershell
.\voyeur.ps1 -Domain "test.example.local" -ExportACL -ExportOU -ExportTo JSON
```

This example retrieve information of an Active Directory for a specific domain with explicit credentials and
export results to CSV format.

```powershell
.\voyeur.ps1 -Domain "test.example.local" -AlternateCredential -ExportTo CSV
```

This example retrieve information of an Active Directory for a specific domain and for specific Organizational
Unit (OU). Also, retrieve Organizational Unit information and ACL values. Next, export all data driven to all supported formats
```powershell
.\voyeur.ps1 -Domain "test.example.local" -SearchRoot "OU=Domain,DC=test,DC=example,DC=local" -ExportACL -ExportOU -ExportTo XML,JSON,CSV,EXCEL
```
